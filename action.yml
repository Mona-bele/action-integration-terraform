name: 'API Integration - Github Actions Terraform'
description: 'Communicate with Github Actions and Terraform Cloud'
author: 'Monabele'
inputs:
  tf_api_token:
    description: 'Terraform Cloud API Token'
    required: true
  tf_workspace:
    description: 'Terraform Cloud Workspace'
    required: true
  tf_organization:
    description: 'Terraform Cloud Organization'
    required: true
  tf_run_type:
    description: 'Terraform Cloud Run Type'
    required: true

# Workspace Variables API
  variable_type:
    description: 'Workspace Variable Type'
    required: false
    default: 'var'
  variable_key:
    description: 'Workspace Variable Key'
    required: false
  variable_value:
    description: 'Workspace Variable Value'
    required: false
  variable_category:
    description: 'Workspace Variable Category'
    required: false
    default: 'terraform'
  variable_sensitive:
    description: 'Workspace Variable Sensitive'
    required: false
    default: 'false'
  variable_hcl:
    description: 'Workspace Variable HCL'
    required: false
    default: 'false'
  variable_description:
    description: 'Workspace Variable Description'
    required: false
    default: 'var_description'

# Workspace Variables API Interactions
  delete_variable:
    description: 'Delete Workspace Variable'
    required: false

  create_variable:
    description: 'Create Workspace Variable'
    required: false

runs:
  using: docker
  image: Dockerfile
  env:
    TF_API_TOKEN: ${{ inputs.tf_api_token }}
    TF_WORKSPACE: ${{ inputs.tf_workspace }}
    TF_ORGANIZATION: ${{ inputs.tf_organization }}
    TF_RUN_TYPE: ${{ inputs.tf_run_type }}

  args:
    - "-variable_type=${{ inputs.variable_type }}"
    - "-variable_key=${{ inputs.variable_key }}"
    - "-variable_value=${{ inputs.variable_value }}"
    - "-variable_category=${{ inputs.variable_category }}"
    - "-variable_sensitive=${{ inputs.variable_sensitive }}"
    - "-variable_hcl=${{ inputs.variable_hcl }}"
    - "-variable_description=${{ inputs.variable_description }}"
    - "-delete_variable=${{ inputs.delete_variable }}"
    - "-create_variable=${{ inputs.create_variable }}"

branding:
  icon: 'activity'
  color: 'blue'